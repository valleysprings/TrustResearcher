agent_name: "TrustResearcher"
version: "1.0"

# LLM Configuration
llm:
  # model_name: "gpt-4.1"
  model_name: "gpt-5"
  api_key: <YOUR_API_KEY_HERE>
  base_url: <YOUR_CUSTOM_API_URL_HERE>  # Optional: Custom API endpoint
  max_tokens: 16384  # Unified token limit for all LLM operations
  temperature: 0.8
  # Timeout settings for different operations
  timeouts:
    default: 300  # 5 minutes
    idea_generation: 1800  # 30 minutes for complex generation
    variant_generation: 900  # 15 minutes for variants
    cross_pollination: 600  # 10 minutes for cross-pollination
    merging: 120  # 2 minutes for idea merging
  # Retry settings
  retry:
    max_retries: 5
    delay: 2  # seconds between retries
    timeout: 300  # seconds timeout for retry operations
    idea_merging_retries: 3

# Semantic Scholar integration
semantic_scholar:
  api_key: <YOUR_API_KEY_HERE>
  num_papers: 50
  rate_limit_delay: 1.2  # Increased delay between requests to avoid 429 errors
  time_window: 300.0  # 5 minutes window to match Semantic Scholar limits
  max_calls: 60  # Reduced from 90 to be more conservative
  max_papers_per_search: 50
  # Network timeouts
  timeout: 30  # seconds for HTTP requests
  # Enhanced search configuration - reduced to prevent too many parallel queries
  max_concepts: 8  # Reduced from 20 to limit query generation
  max_queries_per_layer: 5  # Reduced from 10 to limit parallel queries
  combination_order: "rev"  # 'rev' (descending) or 'fwd' (ascending) combination sizing
  topic_decomposition_tokens: 2048  # Token limit for topic decomposition
  # Paper scoring parameters
  scoring:
    relevance_weight: 0.7          # Weight for concept relevance score (0-1)
    citation_weight: 0.3           # Weight for citation impact score (0-1)
    citation_normalization: 10000   # Normalize citation count by this value
  # Query generation limits
  search_limits:
    max_total_queries: 8           # Max total queries to prevent rate limiting
    max_queries_per_iteration: 4   # Max queries per iteration in iterative search
    papers_per_query: 10           # Papers to request per individual query
    abstract_truncate_length: 500  # Abstract truncation for keyword extraction
  # Text filtering
  title_normalization:
    exclude_articles: ["a", "an", "the"]  # Articles to exclude in title normalization

# External Selector for filtering ideas based on literature distinctness
external_selector:
  similarity_threshold: 0.7
  high_similarity_threshold: 0.8
  low_similarity_threshold: 0.3
  similarity_method: "tfidf"  # Options: "tfidf", "bge", "stella", "jina"
  # TF-IDF vectorizer settings
  tfidf:
    max_features: 1000
    stop_words: "english"
    ngram_range: [1, 2]  # Use 1-grams and 2-grams
    min_df: 1
  # Display limits
  max_similarity_details: 5  # Top N most similar papers to show
  # Portfolio quality thresholds
  distinctness_excellent_ratio: 0.8  # >=80% distinct ideas = excellent
  distinctness_moderate_ratio: 0.5   # >=50% distinct ideas = moderate
  # Text processing
  text_processing:
    sentence_overlap_threshold: 0.7  # Threshold for sentence overlap detection
    max_sentences_per_section: 5     # Max sentences in merged text sections

knowledge_graph:
  enabled: true
  paper_batch_size: 3  # Number of papers to process in each batch for KG insertion
  default_relationship_weight: 0.8  # Default weight for KG relationships
  expansion:
    seed_sample_size: 10
    sampling_strategy: "degree"
  relationship_enhancement:
    sampling_strategy: "degree"
    sample_size: 20
    top_degree_ratio: 0.6
    random_ratio: 0.4
    iterations: 2
    max_sampling_attempts: 3

# Faceted Decomposition Configuration
faceted_decomposition:
  knowledge_graph:
    max_entities_display: 10     # Max entities to show in context
    max_relationships_display: 5  # Max relationships to show in context
    max_entities_context: 15     # Max entities for full context
    max_relationships_context: 10 # Max relationships for full context
  validation:
    min_content_threshold: 50    # Minimum character length for valid facets

# Graph of Thought Configuration - Path Sampling from KG
graph_of_thought:
  # Core parameters
  max_paths: 100                    # Maximum reasoning paths to extract
  max_kg_entities: 20               # Max KG entities to import as thoughts

  # Bridge connections (minimal generation to connect graph)
  max_bridges_per_facet: 3          # Max bridge connections per facet to KG entities
  bridge_connection_weight: 0.7     # Weight for bridge connections between facets and KG

  # Path sampling
  max_path_length: 5                # Maximum path length (number of hops)
  path_branching_factor: 3          # Number of successors to explore per node in DFS
  min_path_score: 0.5               # Minimum path quality score for retention
  max_starting_nodes: 10            # Max KG nodes to use as DFS starting points

  # Path scoring weights
  node_quality_weight: 0.6          # Weight for average node scores
  edge_diversity_weight: 0.2        # Weight for edge type diversity
  path_length_weight: 0.2           # Weight for optimal path length

  # Thought formatting
  max_neighbors_per_entity: 5       # Max neighbors to consider when formatting entity
  max_relationships_display: 3      # Max relationships to show in thought description

  # Debug logging (controlled by global logging.level=DEBUG)
  max_cross_connections_logged: 20  # Max cross-connections to log in debug output

# Planning Module Configuration
planning_module:
  literature:
    max_referenced_papers: 5       # Max papers to reference in plan
    max_displayed_authors: 2       # Max authors to display per paper
    max_keywords_display: 5        # Max keywords to show per paper
    max_limitations_display: 3     # Max limitations to extract
    abstract_truncate_length: 300  # Abstract truncation length
    max_gaps_identified: 5         # Max research gaps to identify
    max_methodology_keywords: 5    # Max methodology terms to extract
    max_papers_for_limitations: 3  # Max papers to check for limitations
  knowledge_graph:
    max_related_entities: 10       # Max related entities from KG
    max_cross_connections: 3       # Max cross-cluster connections
    max_relationships_per_entity: 2 # Max relationships per entity

# Aggregator Configuration
aggregator:
  recommendations:
    max_review_suggestions: 3        # Max suggestions from review feedback
    max_novelty_suggestions: 2       # Max suggestions from novelty feedback
  scoring:
    good_score_threshold: 4.0        # Threshold for good overall scores
  portfolio_assessment:
    excellent_threshold: 4.0         # Threshold for excellent portfolio
    good_threshold: 3.5              # Threshold for good portfolio
    moderate_threshold: 3.0          # Threshold for moderate portfolio
    weak_threshold: 2.0              # Threshold for weak portfolio
    max_top_ideas: 3                 # Max top ideas to show in portfolio

# Novelty Agent Configuration
novelty_agent:
  scoring:
    default_score: 3.0               # Default novelty score
    high_contribution_threshold: 4.0 # Threshold for high contribution potential
    moderate_high_threshold: 3.5     # Threshold for moderate-high contribution
    moderate_threshold: 2.5          # Threshold for moderate contribution

idea_generation:
  # Enhanced pipeline parameters
  overgeneration_factor: 10  # Generate 10x more ideas than requested
  intermediate_selection_multiplier: 5  # Select 5x requested ideas for detailed review
  merge_similarity_threshold: 0.85  # Jaccard similarity threshold for merging ideas (high threshold)

  # Variant generation strategy (total = 1.2x overgeneration_factor)
  total_generation_multiplier: 1.2  # Total generation multiplier (1.2x overgeneration)
  base_variant_ratio: 0.4           # Base variants: 0.4x overgeneration
  got_variant_ratio: 0.4            # GoT variants: 0.4x overgeneration
  pollination_ratio: 0.4            # Cross-pollination: 0.4x overgeneration

  # Iteration and safety limits
  max_merge_iterations: 20  # Maximum iterations for idea merging
  initial_multiplier: 3  # Multiplier for initial ideas before merging

  # Refinement pipeline control
  enable_self_critique: true        # Enable round 2: self-critique refinement
  enable_elaboration: false          # Enable round 3: experimental validation elaboration

  # Literature processing limits
  literature_summary_papers: 5     # Max papers in summary
  literature_summary_authors: 3    # Max authors to show
  literature_abstract_length: 200  # Abstract truncation length
  literature_keywords: 5           # Max keywords to show
  common_themes: 10                # Max common themes
  top_papers_context: 3            # Top papers for context
  cross_connections: 2             # Max cross-connections
  hybrid_ideas_limit: 3            # Max hybrid ideas

  # Methodology elaboration
  methodology_elaboration:
    enabled: true
    validation_components: 4
    async_batch_size: 3

  # Default values
  num_ideas: 3                     # Default number of ideas to generate

  # Scores
  default_overall_score: 4.0       # Default critique score
  default_facet_score: 3           # Default score for novelty/feasibility/clarity/impact
  critique_weights:
    novelty: 0.25
    feasibility: 0.20
    clarity: 0.20
    impact: 0.25
    methodology_soundness: 0.10

  # Processing limits
  min_ideas_for_cross_poll: 2      # Minimum ideas needed for cross-pollination
  max_ideas_for_cross_poll: 5      # Maximum ideas to use for cross-pollination
  hybrid_ideas_final_limit: 1      # Final limit for hybrid ideas

  # Async function limits
  async_func_max_size: 2           # Max concurrent async function calls
  expansion_async_max_size: 3      # Max concurrent expansion async calls

reviewing:
  enabled: true
  novelty_check: true
  # Scoring thresholds for recommendations
  thresholds:
    accept: 4.0           # Score >= 4.0 for accept recommendation
    minor_revise: 3.5     # Score >= 3.5 for minor revisions
    major_revise: 2.5     # Score >= 2.5 for major revisions
    # Below 2.5 = reject
  # Analysis limits
  max_bullet_points: 5    # Maximum bullet points in analysis
  max_summary_length: 100 # Maximum length for idea summaries
  # Pattern detection thresholds
  pattern_threshold: 0.3  # Threshold for detecting common issues (30% of reviews)

proofreading:
  enabled: true

# Token cost tracking
token_cost:
  enabled: true
  fallback_model: "gpt-4"  # Model to use for cost calculation if main model not found
  # Token estimation settings
  words_per_token: 0.75  # Estimation: 1 token â‰ˆ 0.75 words

# Agent-specific configurations
reviewer_agent:
  review_criteria:
    novelty:
      weight: 0.25
      description: "Originality and innovation of the approach"
    feasibility:
      weight: 0.20
      description: "Technical and practical implementability"
    clarity:
      weight: 0.20
      description: "Clear problem definition and methodology"
    impact:
      weight: 0.25
      description: "Potential significance and contribution"
    methodology_soundness:
      weight: 0.10
      description: "Scientific rigor of proposed methods"
  # Weight validation tolerance
  weight_tolerance: 0.01  # Allow small floating point errors
  # Default scores
  default_originality_score: 3
  default_score: 3.0
  # Optional: Add custom criteria
  # ethics:
  #   weight: 0.05
  #   description: "Ethical considerations and implications"
  # reproducibility:
  #   weight: 0.15
  #   description: "Reproducibility and replicability of results"


internal_selector:
  selection_criteria:
    novelty:
      weight: 0.30
      description: "Originality and uniqueness of research direction"
    feasibility:
      weight: 0.25
      description: "Realistic implementation given current resources"
    clarity:
      weight: 0.20
      description: "Clear problem definition and approach"
    impact:
      weight: 0.25
      description: "Potential significance and broad applicability"
  batch_size: 50  # Number of ideas to evaluate in parallel
  # Merging settings
  default_merge_threshold: 0.85  # Default Jaccard similarity threshold for merging
  sentence_dedup_threshold: 0.7  # Threshold for sentence deduplication when merging
  # Processing limits
  large_dataset_threshold: 50    # Threshold for switching to efficient algorithm
  # Scoring fallbacks
  fallback_scoring:
    base_score: 3.0              # Base score for fallback evaluation
    topic_length_modifier: 0.5   # Modifier based on topic length
  # Content truncation
  content_limits:
    problem_statement_length: 200 # Truncate problem statements to this length
    methodology_length: 200      # Truncate methodology to this length
    validation_length: 200       # Truncate validation to this length
  # Retry settings
  retry:
    idea_merging_retries: 3      # Max retries for idea merging operations

# UI Configuration
ui:
  ports:
    process: 7860  # Research process UI port
  startup_delay: 1  # Seconds to wait between launching UIs

logging:
  level: "DEBUG"
  file: "logs/agent.log"
